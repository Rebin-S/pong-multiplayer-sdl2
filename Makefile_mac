CC = gcc
CFLAGS = -Wall -g -I/opt/homebrew/include
LDFLAGS = $(shell sdl2-config --libs) -lSDL2_image -lSDL2_ttf -lSDL2_net -lSDL2_mixer

COMMON_SRC = background.c score.c menu.c music.c
COMMON_OBJ = $(COMMON_SRC:.c=.o)

CLIENT_SRC = client.c
CLIENT_OBJ = $(CLIENT_SRC:.c=.o)

SERVER_SRC = server.c ball.c paddle.c score.c menu.c music.c
SERVER_OBJ = $(SERVER_SRC:.c=.o)

MAIN_SRC = main.c ball.c paddle.c background.c score.c menu.c music.c
MAIN_OBJ = $(MAIN_SRC:.c=.o)

EXEC = pong

all: $(EXEC) client server

$(EXEC): $(MAIN_OBJ)
	$(CC) -o $@ $^ $(LDFLAGS)

client: $(CLIENT_OBJ) ball.o $(COMMON_OBJ)
	$(CC) -o $@ $^ $(LDFLAGS)

server: $(SERVER_OBJ)
	$(CC) -o $@ $^ $(LDFLAGS)

%.o: %.c
	$(CC) $(CFLAGS) -c $< -o $@

clean:
	rm -f *.o pong client server
